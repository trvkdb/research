copied over code for amplitude mode subroutine/fft subroutine

need to update code for my version.

